---
title: "Fortranから使うPLplot入門 #3: 座標軸をカスタマイズする[JA]"
date: 2025-07-XX
link: https://shinobuamasaki.github.io/items/introduction-to-plplot-using-fortran-003.html
language: ja
author: 雨崎しのぶ（Amasaki Shinobu）
description: "FortranからPLplotライブラリを使う解説記事 その3\\: 座標軸をカスタマイズする"
---

# Fortranから使うPLplot入門 #3

1. [Fortranから使うPLplot入門 #1](https://qiita.com/amasaki203/items/1dbeb02a2adb7265654d) - インストールとHello World
2. [Fortranから使うPLplot入門 #2]() - 直線と曲線、散布図を描く
3. Fortranから使うPLplot入門 #3 - 座標軸をカスタマイズする（この記事）

## はじめに

第2回までに、文字や曲線の描画および描画領域の設定について扱いました。第3回となる本稿では、PLplotにおける座標軸のカスタマイズについて解説します。

## 目次

- はじめに
- 座標軸の設定
- まとめ
- 参考文献

## 座標軸の設定

### `plenv`の役割

第1回で触れたとおり、通常の座標軸（フレーム）は以下のように`plenv`に6つの引数を与えてを呼び出すことで設定されます。

```fortran
frame: block
   real(plflt), parameter :: xmin = 0d0, xmax = 1d0
   real(plflt), parameter :: ymin = -1d0, ymax = 1d0
   integer(plint) :: just, axis
   
   just = 0
   axis = 0
   call plenv(xmin, xmax, ymin, ymax, just, axis)
end block frame
```

この時`plenv`では

ここで、`xmin`と`xmax`はそれぞれx座標の最小値と最大値を、`ymin`と`ymax`はそれぞれy座標の最小値と最大値を指します。
第5引数の`just`は、軸がどのようにスケールされるかを`-1`, `0`, `1`, `2`の整数で指示しています。

- `-1`: スケールを設定しない
- `0`: x軸とy軸は、独立に拡大縮小される
- `1`: x軸とy軸のスケールの比率を等しくする
- `2`: x軸とy軸の軸の長さを等しくし、描画領域を正方形にする

最後の引数`axis`は、一番ややこしいですが、次のようにして設定と整数値が対応していますが、ここではその内のいくつかを示します。
なお、以下ではマップ領域の外側を囲む四方の枠のことを「ボックス」と呼びます。

- `-2`: ボックス、ティックマーク、数値ラベル、座標軸の一切を描画しない
- `-1`: ボックスのみを描画する
- `0`: ボックス、ティックマーク、数値ラベルを描画する
- `1`: 加えて、`x=0`, `y=0`の座標軸を描画する
- `2`: 加えて、両座標軸の主ティックマークにグリッドを描画する
- `3`: 加えて、両座標軸の副ティックマークにグリッドを描画する

これらのほかに10番台から30番台では対数スケールでの座標軸の指定を、40番台から60番台では日時タイプのラベルの指定を、70番台ではカスタムラベルの指定を命令することが可能です。


### より詳細なセットアップ

## 極座標で描きたい

PLplotにおいて、極座標グラフをプロットするための簡単に扱える手続きは存在しません。

これはつまり、極座標で簡単に書ける方程式（例えばアルキメデスの螺旋, $r = a\theta$）でも、その曲線をプロットするには、デカルト座標での点の配列として`plline`手続きに渡す必要があるということです。

加えて、極座標のグラフをきちんと書きたい場合には、[公式ドキュメントの例題3](https://plplot.sourceforge.net/examples.php?demo=03&lbind=Fortran)のように、距離の円、偏角の軸、数値ラベル等をすべて手動で描画させる必要があります。

## 数値ラベルを自由に扱う

- 座標軸にπ単位、πの分数単位のラベルを付ける方法について

## 例題

このセクションでは、本稿のテーマである座標軸のカスタマイズに関する実践的な例題を提供します。

1. 地震学におけるグーテンベルグ・リクター則
2. Lax-Friedrich差分法スキームの増幅率
3. 時系列データの取り扱い

### 例題１ - 地震学におけるグーテンベルグ・リクター則

まず最初の例題として、ここでは、片対数グラフのプロットを行う方法について述べます。

- Fortranを使ってデータセットから値を集計し、配列に格納する
- PLplotで片対数グラフを構成し、配列の値をプロットする
- 配列の値から対数回帰線を計算し、これをプロットする
- PNGファイルとして出力する

地震学におけるグーテンベルグ・リクター則（GR則）とは、

例として扱うデータセットは、[気象庁の「地震月報（カタログ編）」](https://www.data.jma.go.jp/eqev/data/bulletin/index.html)の[震源データ](https://www.data.jma.go.jp/eqev/data/bulletin/hypo.html)のページで公開されている、2018年から2022年までの5年間の地震活動に関するファイル（h2018.zip, h2019.zip, h2020.zip, h2021.zip, h2022.zip）を使用します。

なお、このデータの利用にあたっては[「地震月報（カタログ編）- 利用にあたって」](https://www.data.jma.go.jp/eqev/data/bulletin/readme_j.html)を読んでください。

これらのファイル（例えば`h2022.zip`）を解凍して得られるデータファイル（同様に`h2022`）は、96バイト固定長レコードのテキストで構成されています。
フォーマットの詳細は[震源レコードフォーマット](https://www.data.jma.go.jp/eqev/data/bulletin/data/format/hypfmt_j.html)を参照してください。

この例で必要となるのはマグニチュードの値です。あるマグニチュードの範囲（例えば0.1刻みなど）で全レコードを集計して、地震規模に対する発生回数のデータを得ます。



### 例題2 - Lax-Friedrich差分法スキームの増幅率

ここでは、極座標のプロットを行う方法について述べます。

### 例題3 - 時系列データ：

最後に、横軸を日付・時刻とするグラフのプロットを行う方法について述べます。

## まとめ



## 参考文献

- https://plplot.sourceforge.net/docbook-manual/plplot-html-5.15.0/plenv.html
- https://plplot.sourceforge.net/examples.php?demo=03&lbind=Fortran

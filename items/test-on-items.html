<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="utf-8" />
	  	<meta name="description" content="test" />
		<title>Test Fortran code | Amasaki Shinobu's Website</title>
	<link rel="stylesheet" type="text/css" href="https://shinobuamasaki.github.io/style/highlight.css">
	<script src="https://shinobuamasaki.github.io/style/highlight.min.js"></script>
	<script>hljs.highlightAll();</script>
</head>
<body>
	<h1 id="hello-world-code-with-coarray-in-modern-fortran">Hello world
code with coarray in modern Fortran</h1>
<p>Following code is written in modern Fortran with Coarray
extension.</p>
<pre class="fortran"><code>program main
   use, intrinsic :: iso_fortran_env, only: int32
   implicit none

   integer(int32), codimension[*] :: array
   integer(int32) :: thisis, petot

   thisis = this_image()
   petot = num_images()

   print &#39;(a,i0,a,i0)&#39;, &#39;Hello coarray world, this processor element is &#39;, thisis, &#39;/&#39;, petot
   sync all

end program main</code></pre>
<p>Above code is executed and outs following:</p>
<pre class="bash"><code>% export FPM_FC=caf
% export FPM_FFLAGS=&quot;-I/usr/lib64 -I/usr/include -fcoarray=lib&quot;

% fpm install --prefix .
% cafrun -n 64 bin/hellocoarray
Hello coarray world, this is 17/64
Hello coarray world, this is 18/64
Hello coarray world, this is 19/64
Hello coarray world, this is 20/64
Hello coarray world, this is 21/64
Hello coarray world, this is 22/64
Hello coarray world, this is 23/64
Hello coarray world, this is 24/64
Hello coarray world, this is 25/64
Hello coarray world, this is 26/64
Hello coarray world, this is 27/64
Hello coarray world, this is 28/64
Hello coarray world, this is 29/64
Hello coarray world, this is 30/64
Hello coarray world, this is 31/64
Hello coarray world, this is 32/64
Hello coarray world, this is 33/64
Hello coarray world, this is 34/64
Hello coarray world, this is 35/64
Hello coarray world, this is 36/64
Hello coarray world, this is 37/64
Hello coarray world, this is 38/64
Hello coarray world, this is 39/64
Hello coarray world, this is 40/64
Hello coarray world, this is 41/64
Hello coarray world, this is 42/64
Hello coarray world, this is 43/64
Hello coarray world, this is 44/64
Hello coarray world, this is 45/64
Hello coarray world, this is 46/64
Hello coarray world, this is 47/64
Hello coarray world, this is 48/64
Hello coarray world, this is 49/64
Hello coarray world, this is 50/64
Hello coarray world, this is 51/64
Hello coarray world, this is 52/64
Hello coarray world, this is 53/64
Hello coarray world, this is 54/64
Hello coarray world, this is 55/64
Hello coarray world, this is 56/64
Hello coarray world, this is 57/64
Hello coarray world, this is 58/64
Hello coarray world, this is 59/64
Hello coarray world, this is 60/64
Hello coarray world, this is 61/64
Hello coarray world, this is 62/64
Hello coarray world, this is 63/64
Hello coarray world, this is 64/64
Hello coarray world, this is 4/64
Hello coarray world, this is 5/64
Hello coarray world, this is 6/64
Hello coarray world, this is 7/64
Hello coarray world, this is 8/64
Hello coarray world, this is 9/64
Hello coarray world, this is 10/64
Hello coarray world, this is 11/64
Hello coarray world, this is 12/64
Hello coarray world, this is 13/64
Hello coarray world, this is 14/64
Hello coarray world, this is 15/64
Hello coarray world, this is 16/64
Hello coarray world, this is 1/64
Hello coarray world, this is 2/64
Hello coarray world, this is 3/64</code></pre>
<p>The compiler command <code>caf</code> is implemented by OpenCoarrays.
<code>cafrun</code> is the execution command.</p>
<p>Above <code>FFLAGS</code>(<code>FPM_FFLAGS</code>) is set for Gentoo
Linux:</p>
<ul>
<li><code>/usr/lib64</code> includes the <code>mpi_f08.mod</code> file
of gfortran.</li>
<li><code>/usr/include</code> tend to include other <code>*.mod</code>
files.</li>
</ul>
</body>
</html>
